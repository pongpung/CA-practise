<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ICAB Accounting Exam â€“ Company Financial Statements</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .question-tracker-item {
            transition: all 0.2s ease-in-out;
        }
        .question-tracker-item:hover {
            transform: scale(1.1);
        }
        .option-label {
            transition: background-color 0.2s ease;
        }
        .option-label.selected {
            background-color: #dbeafe; /* blue-100 */
            border-color: #3b82f6; /* blue-500 */
        }
        .results-section .correct {
            background-color: #dcfce7; /* green-100 */
        }
        .results-section .incorrect {
            background-color: #fee2e2; /* red-100 */
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div id="quiz-container" class="max-w-7xl mx-auto p-4 sm:p-6 lg:p-8">
        <h1 class="text-2xl sm:text-3xl font-bold text-center text-gray-900 mb-6">ICAB Accounting Exam â€“ Chapter 12: Company Financial Statements</h1>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
            <!-- Left Side: Question Tracker -->
            <div class="lg:col-span-2 order-2 lg:order-1 bg-white p-4 rounded-lg shadow-md">
                <h2 class="font-bold mb-4 text-center">Question Tracker</h2>
                <div id="question-tracker" class="grid grid-cols-5 gap-2">
                    <!-- Tracker items will be generated by JS -->
                </div>
            </div>

            <!-- Center: Question and Answer -->
            <div class="lg:col-span-8 order-1 lg:order-2 bg-white p-6 rounded-lg shadow-lg">
                <div id="question-area">
                    <!-- Question content will be loaded here -->
                </div>
                <div class="mt-8 flex justify-between items-center">
                    <button id="prev-btn" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-lg">Previous</button>
                    <button id="next-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg">Next</button>
                </div>
            </div>

            <!-- Right Side: Timer and Flag -->
            <div class="lg:col-span-2 order-3 lg:order-3 bg-white p-4 rounded-lg shadow-md text-center">
                <h2 class="font-bold mb-2">Time Remaining</h2>
                <div id="timer" class="text-2xl font-bold text-red-600 mb-6">45:00</div>
                <button id="flag-btn" class="w-full bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-4 rounded-lg">
                    Flag Question
                </button>
            </div>
        </div>

        <!-- Bottom: Submit Button -->
        <div class="mt-8 text-center">
            <button id="submit-btn" class="bg-green-600 hover:bg-green-700 text-white font-extrabold py-3 px-10 rounded-lg text-lg">
                Submit Quiz
            </button>
        </div>
    </div>

    <!-- Results Container -->
    <div id="results-container" class="hidden max-w-5xl mx-auto p-4 sm:p-6 lg:p-8 bg-white rounded-lg shadow-2xl my-10">
        <h1 class="text-3xl font-bold text-center text-gray-900 mb-6">Quiz Results</h1>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-center mb-8">
            <div class="bg-blue-100 p-4 rounded-lg">
                <p class="text-lg font-semibold">Total Score</p>
                <p id="total-score" class="text-3xl font-bold"></p>
            </div>
            <div class="bg-green-100 p-4 rounded-lg">
                <p class="text-lg font-semibold">Correct Answers</p>
                <p id="correct-answers" class="text-3xl font-bold"></p>
            </div>
            <div class="bg-red-100 p-4 rounded-lg">
                <p class="text-lg font-semibold">Incorrect Answers</p>
                <p id="incorrect-answers" class="text-3xl font-bold"></p>
            </div>
            <div class="bg-yellow-100 p-4 rounded-lg">
                <p class="text-lg font-semibold">Percentage</p>
                <p id="percentage" class="text-3xl font-bold"></p>
            </div>
        </div>

        <div class="mb-8 p-4 bg-gray-50 rounded-lg">
            <h2 class="text-xl font-bold mb-3">Performance Analysis</h2>
            <p class="mb-2">Quiz Difficulty: <span id="quiz-difficulty" class="font-semibold bg-purple-200 text-purple-800 py-1 px-2 rounded-full">Tricky</span></p>
            <p class="mb-2">Percentage of Incorrect Answers: <span id="incorrect-percentage" class="font-semibold text-red-600"></span></p>
            <div id="areas-for-improvement">
                <h3 class="text-lg font-semibold mt-4 mb-2">Topics to Revisit:</h3>
                <ul id="improvement-topics-list" class="list-disc list-inside text-gray-700">
                    <!-- Topics will be populated by JS -->
                </ul>
            </div>
        </div>

        <div id="results-section" class="space-y-6">
            <!-- Detailed results will be shown here -->
        </div>

        <div class="mt-10 text-center">
            <button id="retake-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg text-lg">
                Retake Quiz
            </button>
        </div>

        <footer class="text-center text-sm text-gray-500 mt-12 border-t pt-4">
            <p class="font-semibold">Prepared by:</p>
            <p>ðŸ”— <a href="https://www.linkedin.com/in/k-m-mahafuzul-alam" target="_blank" class="text-blue-600 hover:underline">linkedin.com/in/k-m-mahafuzul-alam</a></p>
            <p>ðŸ“ž WhatsApp: 01728-928984</p>
            <p>ðŸ“§ Email: kmmhafuzulalam@gmail.com</p>
        </footer>
    </div>
    
    <!-- Confirmation Modal -->
    <div id="confirmation-modal" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full flex items-center justify-center z-50">
        <div class="bg-white p-8 rounded-lg shadow-xl w-full max-w-md mx-auto">
            <h2 id="modal-title" class="text-2xl font-bold mb-4 text-gray-900">Confirm Submission</h2>
            <p id="modal-message" class="mb-6 text-gray-700">Are you sure you want to submit your answers? You cannot change them after submitting.</p>
            <div class="flex justify-end space-x-4">
                <button id="modal-cancel-btn" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-6 rounded-lg">Cancel</button>
                <button id="modal-confirm-btn" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-lg">Submit</button>
            </div>
        </div>
    </div>


    <script>
        const quizData = [
            // Questions based on PDF Chapter 12
            {
                question: "According to IAS 1, which of the following is NOT a minimum disclosure requirement on the face of the Statement of Profit or Loss?",
                options: ["Revenue", "Gross Profit", "Operating Profit", "Profit before tax"],
                answer: ["Operating Profit"],
                type: "single",
                topic: "Statement of Profit or Loss (IAS 1)"
            },
            {
                question: "A company's trial balance shows administrative salaries of BDT 275,000 and general administrative expenses of BDT 650,000. During the year-end adjustments, it was found that depreciation on office fixtures of BDT 200,000 and an impairment loss on goodwill of BDT 30,000 need to be recorded. Both are to be charged to administrative expenses. What is the final figure for administrative expenses?",
                options: ["BDT 925,000", "BDT 1,125,000", "BDT 1,155,000", "BDT 955,000"],
                answer: ["BDT 1,155,000"],
                type: "calculation",
                topic: "Classification of Expenses"
            },
            {
                question: "Which of the following items would be classified under 'Distribution Costs' in the Statement of Profit or Loss as per IAS 1 functional format?",
                options: ["Carriage inwards on purchases", "Wages of administrative staff", "Sales commission", "Amortisation of intangible assets", "Depreciation of delivery vehicles"],
                answer: ["Sales commission", "Depreciation of delivery vehicles"],
                type: "multiple",
                topic: "Classification of Expenses"
            },
            {
                question: "A company's year-end inventory was valued at BDT 88,905. This includes a product line with a cost of BDT 4,560 which is damaged and is now expected to be sold for BDT 3,875. What is the correct value of closing inventory to be reported in the Statement of Financial Position?",
                options: ["BDT 88,905", "BDT 84,345", "BDT 85,030", "BDT 88,220"],
                answer: ["BDT 88,220"],
                type: "calculation",
                topic: "Inventory Valuation (IAS 2)"
            },
            {
                question: "The Statement of Changes in Equity (SOCE) reconciles the opening and closing balances of each component of equity. Which of the following transactions would be presented in the SOCE?",
                options: ["Profit for the period", "Dividends paid to equity shareholders", "A bonus issue of shares from retained earnings", "Purchase of non-current assets financed by a loan"],
                answer: ["Profit for the period", "Dividends paid to equity shareholders", "A bonus issue of shares from retained earnings"],
                type: "multiple",
                topic: "Statement of Changes in Equity (IAS 1)"
            },
            {
                question: "Redeemable preference shares are treated as a liability, whereas irredeemable preference shares are treated as equity.",
                options: ["True", "False"],
                answer: ["True"],
                type: "true_false",
                topic: "Statement of Financial Position (IAS 1)"
            },
            {
                question: "In the Statement of Financial Position, 'Trade and other receivables' includes trade receivables net of the ________ for receivables.",
                options: ["provision", "allowance", "accrual", "prepayment"],
                answer: ["allowance"],
                type: "fill_blank",
                topic: "Statement of Financial Position (IAS 1)"
            },
            {
                question: "A company issued 20,000 BDT 1 equity shares at BDT 1.50 per share. How would this transaction affect the Statement of Changes in Equity?",
                options: ["Increase Share Capital by BDT 30,000", "Increase Share Premium by BDT 10,000 and Share Capital by BDT 20,000", "Increase Retained Earnings by BDT 30,000", "Increase Share Capital by BDT 10,000 and Share Premium by BDT 20,000"],
                answer: ["Increase Share Premium by BDT 10,000 and Share Capital by BDT 20,000"],
                type: "single",
                topic: "Statement of Changes in Equity (IAS 1)"
            },
            {
                question: "Which of the following statements regarding the presentation of financial statements under IAS 1 is correct?",
                options: ["All expenses must be presented as positive numbers in the Statement of Profit or Loss.", "The 'Operating profit' sub-total is a mandatory requirement of IAS 1.", "Financial statements should normally cover a period of exactly one calendar year.", "An entity must present an analysis of expenses based on either their nature or their function."],
                answer: ["An entity must present an analysis of expenses based on either their nature or their function."],
                type: "single",
                topic: "Presentation of Financial Statements (IAS 1)"
            },
            {
                question: "A company has a tax liability of BDT 15,000 for the current year. The tax account in the trial balance shows a debit balance of BDT 2,500 relating to an under-provision from the previous year. The income tax expense in the Statement of Profit or Loss for the current year is:",
                options: ["BDT 12,500", "BDT 15,000", "BDT 17,500", "BDT 2,500"],
                answer: ["BDT 17,500"],
                type: "calculation",
                topic: "Income Tax"
            },
            {
                question: "Which of the following items would be included under 'Other Income' in the Statement of Profit or Loss?",
                options: ["Interest received on savings", "Dividends received on investments", "Profit on disposal of property, plant and equipment", "All of the above"],
                answer: ["Profit on disposal of property, plant and equipment"],
                type: "single",
                topic: "Statement of Profit or Loss (IAS 1)"
            },
            {
                question: "A 1 for 8 bonus issue was made out of retained earnings when a company had 800,000 BDT 1 equity shares in issue. What is the journal entry to record this transaction?",
                options: ["Dr Retained Earnings BDT 100,000, Cr Share Capital BDT 100,000", "Dr Share Premium BDT 100,000, Cr Share Capital BDT 100,000", "Dr Retained Earnings BDT 800,000, Cr Share Capital BDT 800,000", "No journal entry is required for a bonus issue."],
                answer: ["Dr Retained Earnings BDT 100,000, Cr Share Capital BDT 100,000"],
                type: "single",
                topic: "Statement of Changes in Equity (IAS 1)"
            },
            {
                question: "Under IAS 1, which of the following are combined under the heading 'Property, plant and equipment' on the face of the Statement of Financial Position?",
                options: ["Land and Buildings", "Fixtures and Fittings", "Right-of-use assets", "Goodwill"],
                answer: ["Land and Buildings", "Fixtures and Fittings"],
                type: "multiple",
                topic: "Statement of Financial Position (IAS 1)"
            },
            {
                question: "Deferred income represents income received but not yet earned and is classified as a:",
                options: ["Non-current asset", "Current asset", "Non-current liability", "Current liability"],
                answer: ["Current liability"],
                type: "single",
                topic: "Statement of Financial Position (IAS 1)"
            },
            {
                question: "A company's retained earnings at the start of the year were BDT 1,100,000. Profit for the year was BDT 1,049,000. A bonus issue of BDT 100,000 was made from retained earnings. No dividends were paid. The closing balance of retained earnings is:",
                options: ["BDT 2,049,000", "BDT 2,149,000", "BDT 2,249,000", "BDT 1,949,000"],
                answer: ["BDT 2,049,000"],
                type: "calculation",
                topic: "Statement of Changes in Equity (IAS 1)"
            },
            {
                question: "The functional classification of expenses is considered more relevant as it provides a better indication of a company's performance by linking costs to the activities that generate revenue.",
                options: ["True", "False"],
                answer: ["True"],
                type: "true_false",
                topic: "Classification of Expenses"
            },
            {
                question: "Which of the following would NOT be classified as a finance cost?",
                options: ["Interest on bank overdrafts", "Dividends paid on redeemable preference shares", "Interest on 6% loan notes", "Dividends paid on irredeemable preference shares"],
                answer: ["Dividends paid on irredeemable preference shares"],
                type: "single",
                topic: "Classification of Expenses"
            },
            {
                question: "An entity must present an additional Statement of Financial Position as at the beginning of the earliest comparative period when it:",
                options: ["Applies an accounting policy retrospectively", "Makes a retrospective restatement of items", "Reclassifies items in its financial statements", "All of the above"],
                answer: ["All of the above"],
                type: "all_of_above",
                topic: "Presentation of Financial Statements (IAS 1)"
            },
            // ... Adding more questions to reach 50
            { question: "A company depreciates fixtures and fittings at 20% on a straight-line basis. The cost of fixtures is BDT 2,000,000. The depreciation charge for the year is:", options: ["BDT 200,000", "BDT 400,000", "BDT 100,000", "BDT 500,000"], answer: ["BDT 400,000"], type: "calculation", topic: "Adjustments & PPE" },
            { question: "If a debt of BDT 15,000 is written off as irrecoverable and the allowance for receivables is increased from BDT 100,000 to BDT 200,000, the total charge to administrative expenses is:", options: ["BDT 15,000", "BDT 100,000", "BDT 115,000", "BDT 215,000"], answer: ["BDT 115,000"], type: "calculation", topic: "Adjustments & Receivables" },
            { question: "Bank overdrafts are classified as short-term borrowings under current liabilities and are not offset against cash balances unless a right of set-off exists.", options: ["True", "False"], answer: ["True"], type: "true_false", topic: "Statement of Financial Position (IAS 1)" },
            { question: "The primary purpose of the Statement of Changes in Equity is to:", options: ["Show the company's profitability over a period", "Detail all changes in assets and liabilities", "Reconcile the opening and closing balances of equity components", "List all transactions with non-owners"], answer: ["Reconcile the opening and closing balances of equity components"], type: "single", topic: "Statement of Changes in Equity (IAS 1)" },
            { question: "Which of the following are components of equity shown in the Statement of Changes in Equity?", options: ["Share capital", "Share premium", "Retained earnings", "Long-term borrowings"], answer: ["Share capital", "Share premium", "Retained earnings"], type: "multiple", topic: "Statement of Changes in Equity (IAS 1)" },
            { question: "Cost of sales for a trading company is calculated as: Opening Inventory + ________ - Closing Inventory.", options: ["Sales", "Purchases + Carriage Inwards", "Carriage Outwards", "Administrative Expenses"], answer: ["Purchases + Carriage Inwards"], type: "fill_blank", topic: "Statement of Profit or Loss (IAS 1)" },
            { question: "An impairment loss on goodwill is typically charged to which expense category?", options: ["Cost of Sales", "Distribution Costs", "Administrative Expenses", "Finance Costs"], answer: ["Administrative Expenses"], type: "single", topic: "Classification of Expenses" },
            // Case Study
            {
                question: "<b>Case Study (Questions 26-28):</b> Dhaka Trading Ltd.'s trial balance at 31 Dec 20X3 shows: Revenue BDT 9,500,000; Opening Inventory BDT 1,950,000; Purchases BDT 5,125,000; Distribution Expenses BDT 616,000. Closing inventory is BDT 2,020,000. Depreciation on delivery vans (part of distribution) for the year is BDT 200,000 but has not been recorded. What is the total Cost of Sales for the year?",
                options: ["BDT 5,055,000", "BDT 5,255,000", "BDT 4,855,000", "BDT 7,075,000"],
                answer: ["BDT 5,055,000"],
                type: "calculation",
                topic: "Case Study: P&L"
            },
            {
                question: "<b>Case Study (Continued):</b> Based on the information for Dhaka Trading Ltd., what is the final figure for Distribution Costs to be shown in the Statement of Profit or Loss?",
                options: ["BDT 616,000", "BDT 416,000", "BDT 816,000", "BDT 200,000"],
                answer: ["BDT 816,000"],
                type: "calculation",
                topic: "Case Study: P&L"
            },
            {
                question: "<b>Case Study (Continued):</b> If Dhaka Trading Ltd.'s profit before tax is BDT 1,799,000 and the income tax expense is BDT 750,000, what is the profit for the period?",
                options: ["BDT 2,549,000", "BDT 1,049,000", "BDT 1,799,000", "Cannot be determined"],
                answer: ["BDT 1,049,000"],
                type: "calculation",
                topic: "Case Study: P&L"
            },
            { question: "Which of the following is NOT a current liability?", options: ["Trade Payables", "Income Tax Payable", "6% Loan Notes repayable in 10 years", "Bank Overdraft"], answer: ["6% Loan Notes repayable in 10 years"], type: "single", topic: "Statement of Financial Position (IAS 1)" },
            { question: "Dividends paid on redeemable preference shares are treated as a finance cost in the Statement of Profit or Loss.", options: ["True", "False"], answer: ["True"], type: "true_false", topic: "Classification of Expenses" },
            { question: "The IAS 1 format for the Statement of Financial Position requires a split between:", options: ["Tangible and Intangible assets", "Current and Non-current assets/liabilities", "Operating and Investing activities", "Equity and Debt"], answer: ["Current and Non-current assets/liabilities"], type: "single", topic: "Statement of Financial Position (IAS 1)" },
            { question: "A company's trial balance shows 'Loan note interest' of BDT 30,000 for the six months to 30 June. The loan is a 6% BDT 1,000,000 loan note. What is the total finance cost for the full year?", options: ["BDT 30,000", "BDT 60,000", "BDT 1,000,000", "BDT 120,000"], answer: ["BDT 60,000"], type: "calculation", topic: "Adjustments & Finance Costs" },
            { question: "Which of these items are disclosed separately on the face of the Statement of Financial Position under IAS 1?", options: ["Goodwill", "Inventories", "Cash and cash equivalents", "Provisions"], answer: ["Goodwill", "Inventories", "Cash and cash equivalents", "Provisions"], type: "multiple", topic: "Statement of Financial Position (IAS 1)" },
            { question: "The term 'income tax' in IAS 1 refers to the tax on an entity's profits, not PAYE on employee salaries.", options: ["True", "False"], answer: ["True"], type: "true_false", topic: "Statement of Profit or Loss (IAS 1)" },
            { question: "If a company has freehold land at a cost of BDT 2,120,000 and fixtures at a cost of BDT 2,000,000 with accumulated depreciation of BDT 1,300,000, the carrying amount of Property, Plant and Equipment is:", options: ["BDT 4,120,000", "BDT 2,820,000", "BDT 3,220,000", "BDT 700,000"], answer: ["BDT 2,820,000"], type: "calculation", topic: "Adjustments & PPE" },
            { question: "All items of income and expense recognised in a period must be included in ________.", options: ["retained earnings", "profit or loss", "other comprehensive income", "the cash flow statement"], answer: ["profit or loss"], type: "fill_blank", topic: "Statement of Profit or Loss (IAS 1)" },
            { question: "Which of the following is an example of applying professional judgement in classifying expenses?", options: ["Allocating property costs between administrative and distribution functions based on floor space", "Charging the full cost of a new building to expenses in one year", "Ignoring a material error from the previous year", "None of the above"], answer: ["Allocating property costs between administrative and distribution functions based on floor space"], type: "single", topic: "Classification of Expenses" },
            { question: "A company with 150,000 shares in issue makes a 1 for 5 bonus issue out of retained earnings. The retained earnings balance before the issue was BDT 111,450. What is the balance after the bonus issue?", options: ["BDT 111,450", "BDT 81,450", "BDT 91,450", "BDT 30,000"], answer: ["BDT 81,450"], type: "calculation", topic: "Statement of Changes in Equity (IAS 1)" },
            { question: "Which of the following would NOT appear in the Statement of Changes in Equity?", options: ["Issue of share capital", "Dividends paid on redeemable preference shares", "Profit for the year", "Bonus issue of shares"], answer: ["Dividends paid on redeemable preference shares"], type: "single", topic: "Statement of Changes in Equity (IAS 1)" },
            { question: "The main objective of financial statements, according to the Conceptual Framework referenced in IAS 1, is to provide information that is useful to users in making economic decisions.", options: ["True", "False"], answer: ["True"], type: "true_false", topic: "Presentation of Financial Statements (IAS 1)" },
            { question: "Which accounts are debited and credited when accounting for closing inventory?", options: ["Dr Cost of Sales, Cr Inventory", "Dr Inventory, Cr Cost of Sales", "Dr Purchases, Cr Inventory", "Dr Inventory, Cr Purchases"], answer: ["Dr Inventory, Cr Cost of Sales"], type: "single", topic: "Adjustments & Inventory" },
            { question: "A company pays BDT 5,400 for quarterly business insurance in advance on 31 August. At the year-end of 30 September, the prepayment for insurance is:", options: ["BDT 5,400", "BDT 1,800", "BDT 3,600", "BDT 0"], answer: ["BDT 3,600"], type: "calculation", topic: "Adjustments & Prepayments" },
            { question: "Which of the following are qualitative characteristics of useful financial information mentioned in the chapter summary?", options: ["Comparability", "Relevance", "Verifiability", "All of the above"], answer: ["All of the above"], type: "all_of_above", topic: "Presentation of Financial Statements (IAS 1)" },
            { question: "The carrying amount of an asset is its cost or valuation less any accumulated depreciation and accumulated ________ losses.", options: ["impairment", "realised", "unrealised", "disposal"], answer: ["impairment"], type: "fill_blank", topic: "Adjustments & PPE" },
            { question: "A company has trade receivables of BDT 1,820,000. A debt of BDT 15,000 is to be written off. The allowance for receivables is to be set at BDT 200,000. What is the net trade receivables figure in the Statement of Financial Position?", options: ["BDT 1,805,000", "BDT 1,605,000", "BDT 1,620,000", "BDT 1,820,000"], answer: ["BDT 1,605,000"], type: "calculation", topic: "Adjustments & Receivables" },
            { question: "Dividends paid to equity shareholders are presented in the Statement of Profit or Loss as an expense.", options: ["True", "False"], answer: ["False"], type: "true_false", topic: "Statement of Changes in Equity (IAS 1)" },
            { question: "Which of the following are acceptable ways to present expenses as negative numbers in the Statement of Profit or Loss?", options: ["-2,140", "(2,140)", "2,140 CR", "2,140-"], answer: ["-2,140", "(2,140)"], type: "multiple", topic: "Presentation of Financial Statements (IAS 1)" },
            { question: "Rental income received from a property rented to a third party is classified as:", options: ["Revenue", "Other Income", "Finance Income", "A reduction in administrative expenses"], answer: ["Other Income"], type: "single", topic: "Statement of Profit or Loss (IAS 1)" },
            { question: "The par value of a share is:", options: ["The price at which it was issued", "The nominal value of the share", "The current market value of the share", "The book value of the share"], answer: ["The nominal value of the share"], type: "single", topic: "Statement of Financial Position (IAS 1)" },
            { question: "If a company's financial statements do not comply with IFRS, they cannot be described as such, even if accounting policies and notes explain the non-compliance.", options: ["True", "False"], answer: ["True"], type: "true_false", topic: "Presentation of Financial Statements (IAS 1)" }
        ];

        // Shuffle questions for variety on retake
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }
        
        shuffleArray(quizData);
        const totalQuestions = 50;
        const quizQuestions = quizData.slice(0, totalQuestions);


        let currentQuestionIndex = 0;
        let userAnswers = new Array(totalQuestions).fill(null);
        let flaggedQuestions = new Array(totalQuestions).fill(false);
        let timerInterval;

        const quizContainer = document.getElementById('quiz-container');
        const resultsContainer = document.getElementById('results-container');
        const questionTracker = document.getElementById('question-tracker');
        const questionArea = document.getElementById('question-area');
        const timerEl = document.getElementById('timer');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const flagBtn = document.getElementById('flag-btn');
        const submitBtn = document.getElementById('submit-btn');
        const retakeBtn = document.getElementById('retake-btn');
        
        // Modal elements
        const confirmationModal = document.getElementById('confirmation-modal');
        const modalTitle = document.getElementById('modal-title');
        const modalMessage = document.getElementById('modal-message');
        const modalCancelBtn = document.getElementById('modal-cancel-btn');
        const modalConfirmBtn = document.getElementById('modal-confirm-btn');
        let confirmAction = null;


        function startQuiz() {
            currentQuestionIndex = 0;
            userAnswers.fill(null);
            flaggedQuestions.fill(false);
            
            quizContainer.classList.remove('hidden');
            resultsContainer.classList.add('hidden');

            renderQuestionTracker();
            loadQuestion(currentQuestionIndex);
            startTimer(45 * 60);
        }

        function renderQuestionTracker() {
            questionTracker.innerHTML = '';
            for (let i = 0; i < totalQuestions; i++) {
                const item = document.createElement('div');
                item.textContent = i + 1;
                item.classList.add('question-tracker-item', 'w-10', 'h-10', 'flex', 'items-center', 'justify-center', 'font-bold', 'rounded-md', 'cursor-pointer', 'border-2');
                item.dataset.index = i;
                item.addEventListener('click', () => {
                    loadQuestion(i);
                });
                updateTrackerItem(i);
                questionTracker.appendChild(item);
            }
        }

        function updateTrackerItem(index) {
            const item = questionTracker.querySelector(`[data-index='${index}']`);
            if (!item) return;

            item.classList.remove('bg-white', 'bg-green-500', 'bg-red-500', 'text-white', 'border-gray-300', 'border-blue-500', 'ring-2', 'ring-blue-500');

            if (flaggedQuestions[index]) {
                item.classList.add('bg-red-500', 'text-white');
            } else if (userAnswers[index] !== null) {
                item.classList.add('bg-green-500', 'text-white');
            } else {
                item.classList.add('bg-white', 'border-gray-300');
            }

            if (index === currentQuestionIndex) {
                 item.classList.add('border-blue-500', 'ring-2', 'ring-blue-500');
            }
        }

        function loadQuestion(index) {
            const oldIndex = currentQuestionIndex;
            currentQuestionIndex = index;
            const question = quizQuestions[currentQuestionIndex];

            let optionsHtml = '';
            if (question.type === 'true_false' || question.type === 'fill_blank') {
                optionsHtml = `
                    <div class="space-y-3">
                        ${question.options.map((option, i) => `
                            <div>
                                <label class="option-label block border-2 border-gray-300 rounded-lg p-4 cursor-pointer hover:bg-gray-100">
                                    <input type="${question.type === 'multiple' ? 'checkbox' : 'radio'}" name="option" value="${option}" class="mr-3">
                                    ${option}
                                </label>
                            </div>
                        `).join('')}
                    </div>`;
            } else {
                 optionsHtml = `
                    <div class="space-y-3">
                        ${question.options.map((option, i) => `
                            <div>
                                <label class="option-label block border-2 border-gray-300 rounded-lg p-4 cursor-pointer hover:bg-gray-100">
                                    <input type="${question.type === 'multiple' ? 'checkbox' : 'radio'}" name="option" value="${option}" class="mr-3">
                                    <span class="font-bold">${String.fromCharCode(65 + i)}.</span> ${option}
                                </label>
                            </div>
                        `).join('')}
                    </div>`;
            }

            questionArea.innerHTML = `
                <p class="text-sm text-gray-500 mb-2">Question ${currentQuestionIndex + 1} of ${totalQuestions}</p>
                <h2 class="text-xl font-semibold mb-1">${question.question}</h2>
                <p class="text-sm text-gray-600 mb-6">(2 Marks)</p>
                ${optionsHtml}
            `;

            // Restore previous answer
            const savedAnswer = userAnswers[currentQuestionIndex];
            if (savedAnswer) {
                const inputs = questionArea.querySelectorAll('input');
                inputs.forEach(input => {
                    if (Array.isArray(savedAnswer) ? savedAnswer.includes(input.value) : savedAnswer === input.value) {
                        input.checked = true;
                        input.parentElement.classList.add('selected');
                    }
                });
            }
            
            // Add event listeners for new options
            const optionLabels = questionArea.querySelectorAll('.option-label');
            optionLabels.forEach(label => {
                label.addEventListener('click', handleOptionSelect);
            });

            updateNavigationButtons();
            updateFlagButton();
            updateTrackerItem(oldIndex);
            updateTrackerItem(currentQuestionIndex);
        }
        
        function handleOptionSelect(event) {
            const label = event.currentTarget;
            const input = label.querySelector('input');
            const question = quizQuestions[currentQuestionIndex];

            if (question.type === 'multiple') {
                // For checkboxes, just toggle the selected class
                label.classList.toggle('selected', input.checked);
            } else {
                // For radio buttons, remove selected from all and add to the clicked one
                document.querySelectorAll('.option-label').forEach(l => l.classList.remove('selected'));
                label.classList.add('selected');
            }
            saveAnswer();
        }

        function saveAnswer() {
            const question = quizQuestions[currentQuestionIndex];
            const inputs = questionArea.querySelectorAll('input:checked');
            
            if (inputs.length === 0) {
                userAnswers[currentQuestionIndex] = null;
            } else if (question.type === 'multiple') {
                userAnswers[currentQuestionIndex] = Array.from(inputs).map(input => input.value);
            } else {
                userAnswers[currentQuestionIndex] = inputs[0].value;
            }
            updateTrackerItem(currentQuestionIndex);
        }

        function updateNavigationButtons() {
            prevBtn.disabled = currentQuestionIndex === 0;
            prevBtn.classList.toggle('opacity-50', prevBtn.disabled);
            nextBtn.textContent = currentQuestionIndex === totalQuestions - 1 ? 'Finish' : 'Next';
        }

        function updateFlagButton() {
            if (flaggedQuestions[currentQuestionIndex]) {
                flagBtn.textContent = 'Unflag Question';
                flagBtn.classList.replace('bg-orange-500', 'bg-yellow-500');
                flagBtn.classList.replace('hover:bg-orange-600', 'hover:bg-yellow-600');
            } else {
                flagBtn.textContent = 'Flag Question';
                flagBtn.classList.replace('bg-yellow-500', 'bg-orange-500');
                flagBtn.classList.replace('hover:bg-yellow-600', 'hover:bg-orange-600');
            }
        }
        
        function startTimer(duration) {
            let timer = duration;
            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                let minutes = parseInt(timer / 60, 10);
                let seconds = parseInt(timer % 60, 10);

                minutes = minutes < 10 ? "0" + minutes : minutes;
                seconds = seconds < 10 ? "0" + seconds : seconds;

                timerEl.textContent = minutes + ":" + seconds;

                if (--timer < 0) {
                    clearInterval(timerInterval);
                    showModal(
                        "Time's Up!",
                        "The allotted time has expired. Your quiz will now be submitted automatically.",
                        'OK',
                        submitQuiz
                    );
                }
            }, 1000);
        }
        
        function getExplanation(question) {
            // This is a simplified explanation generator. In a real scenario, these would be pre-written.
             switch(question.topic) {
                case "Statement of Profit or Loss (IAS 1)":
                    return `Based on IAS 1 Presentation of Financial Statements, certain items like Revenue and Profit Before Tax are minimum requirements. 'Operating Profit' is commonly presented but not mandatory. This question tests knowledge of IAS 1's specific disclosure requirements.`;
                case "Classification of Expenses":
                    return `IAS 1 allows classification of expenses by nature or function. The functional method (Cost of Sales, Distribution, Admin) is common. This question tests the ability to correctly allocate costs like depreciation, sales commissions, and impairment losses to the appropriate functional category as detailed in the provided text.`;
                case "Inventory Valuation (IAS 2)":
                    return `As per IAS 2 Inventories, inventory must be measured at the lower of cost and net realisable value (NRV). NRV is the estimated selling price less costs to sell. The adjustment of BDT 685 (4,560 - 3,875) reflects this principle. The correct value is BDT 88,905 - 685 = BDT 88,220.`;
                case "Statement of Changes in Equity (IAS 1)":
                    return `The SOCE explains movements in equity accounts. It includes transactions with owners (share issues, dividends) and total comprehensive income (profit for the period). A bonus issue is a reclassification within equity (retained earnings to share capital). Non-owner transactions like asset purchases are excluded.`;
                case "Statement of Financial Position (IAS 1)":
                    return `This topic covers the structure and content of the SFP. Key distinctions include current vs. non-current, and the classification of items like redeemable preference shares (liability) vs. irredeemable (equity), and deferred income (current liability).`;
                case "Income Tax":
                    return `The income tax expense for the P&L includes the current year's tax charge plus or minus any adjustments for prior years. An under-provision from a prior year (a debit balance on the tax account) increases the current year's expense. The calculation is BDT 15,000 (current) + BDT 2,500 (under-provision) = BDT 17,500.`;
                case "Adjustments & PPE":
                    return `This tests calculation of depreciation and carrying amounts. For Format plc, fixtures are depreciated at 20% straight-line on a cost of 2,000,000, resulting in a BDT 400,000 charge. The carrying amount is Cost less Accumulated Depreciation.`;
                case "Adjustments & Receivables":
                    return `The total expense for receivables is the sum of irrecoverable debts written off plus the increase in the allowance. For Format plc, this was BDT 15,000 (write-off) + BDT 100,000 (increase in allowance) = BDT 115,000.`;
                case "Case Study: P&L":
                     return `This scenario is based on the 'Format plc' example. Cost of Sales = Opening Inventory + Purchases - Closing Inventory. Distribution costs include the initial balance plus any additional allocated costs like depreciation on delivery assets. Profit for the period is Profit Before Tax less Income Tax Expense.`;
                default:
                    return `This question tests a core principle from Chapter 12 regarding the preparation of financial statements under IFRS. Refer to the relevant section in the PDF for a detailed breakdown.`;
            }
        }

        function submitQuiz() {
            clearInterval(timerInterval);
            let score = 0;
            let correctCount = 0;
            let incorrectCount = 0;
            const incorrectTopics = new Set();

            quizQuestions.forEach((q, i) => {
                const userAnswer = userAnswers[i];
                const correctAnswer = q.answer;
                let isCorrect = false;

                if (q.type === 'multiple') {
                    isCorrect = Array.isArray(userAnswer) && userAnswer.length === correctAnswer.length && userAnswer.every(val => correctAnswer.includes(val));
                } else {
                    isCorrect = userAnswer === correctAnswer[0];
                }

                if (isCorrect) {
                    score += 2;
                    correctCount++;
                } else {
                    incorrectCount++;
                    incorrectTopics.add(q.topic);
                }
            });

            quizContainer.classList.add('hidden');
            resultsContainer.classList.remove('hidden');

            document.getElementById('total-score').textContent = `${score} / ${totalQuestions * 2}`;
            document.getElementById('correct-answers').textContent = `${correctCount} / ${totalQuestions}`;
            document.getElementById('incorrect-answers').textContent = `${incorrectCount} / ${totalQuestions}`;
            const percentage = totalQuestions > 0 ? ((correctCount / totalQuestions) * 100).toFixed(2) : 0;
            document.getElementById('percentage').textContent = `${percentage}%`;
            const incorrectPercentage = totalQuestions > 0 ? ((incorrectCount / totalQuestions) * 100).toFixed(2) : 0;
            document.getElementById('incorrect-percentage').textContent = `${incorrectPercentage}%`;

            const improvementList = document.getElementById('improvement-topics-list');
            improvementList.innerHTML = '';
            if (incorrectTopics.size > 0) {
                incorrectTopics.forEach(topic => {
                    const li = document.createElement('li');
                    li.textContent = topic;
                    improvementList.appendChild(li);
                });
            } else {
                improvementList.innerHTML = '<li>Excellent work! No specific areas for improvement identified.</li>';
            }
            
            renderDetailedResults();
        }
        
        function renderDetailedResults() {
            const resultsSection = document.getElementById('results-section');
            resultsSection.innerHTML = '';
            quizQuestions.forEach((q, i) => {
                const userAnswer = userAnswers[i];
                const correctAnswer = q.answer;
                let isCorrect = false;
                
                if (q.type === 'multiple') {
                    isCorrect = Array.isArray(userAnswer) && userAnswer.length === correctAnswer.length && userAnswer.every(val => correctAnswer.includes(val));
                } else {
                    isCorrect = userAnswer === correctAnswer[0];
                }

                const resultClass = isCorrect ? 'correct' : 'incorrect';
                const userAnswerText = Array.isArray(userAnswer) ? (userAnswer.join(', ') || 'Not Answered') : (userAnswer || 'Not Answered');
                const correctAnswerText = Array.isArray(correctAnswer) ? correctAnswer.join(', ') : correctAnswer;

                const resultDiv = document.createElement('div');
                resultDiv.className = `p-4 rounded-lg border ${resultClass}`;
                resultDiv.innerHTML = `
                    <p class="font-bold mb-2">Question ${i + 1}: ${q.question}</p>
                    <p>Your Answer: <span class="font-semibold">${userAnswerText}</span></p>
                    <p class="text-green-700 font-bold">âœ… Correct Answer: ${correctAnswerText}</p>
                    <div class="mt-3 pt-3 border-t border-gray-300">
                        <p class="font-semibold">ðŸ“– Explanation:</p>
                        <p class="text-sm text-gray-700">${getExplanation(q)}</p>
                    </div>
                `;
                resultsSection.appendChild(resultDiv);
            });
        }
        
        // Modal logic
        function showModal(title, message, confirmText, onConfirm) {
            modalTitle.textContent = title;
            modalMessage.textContent = message;
            modalConfirmBtn.textContent = confirmText;
            confirmAction = onConfirm;
            confirmationModal.classList.remove('hidden');
        }

        function hideModal() {
            confirmationModal.classList.add('hidden');
            confirmAction = null;
        }

        // Event Listeners
        prevBtn.addEventListener('click', () => {
            if (currentQuestionIndex > 0) {
                loadQuestion(currentQuestionIndex - 1);
            }
        });

        nextBtn.addEventListener('click', () => {
            if (currentQuestionIndex < totalQuestions - 1) {
                loadQuestion(currentQuestionIndex + 1);
            } else {
                 showModal(
                    'Finish Quiz?',
                    'You are on the last question. Are you sure you want to finish and submit the quiz?',
                    'Submit',
                    submitQuiz
                );
            }
        });

        flagBtn.addEventListener('click', () => {
            flaggedQuestions[currentQuestionIndex] = !flaggedQuestions[currentQuestionIndex];
            updateFlagButton();
            updateTrackerItem(currentQuestionIndex);
        });

        submitBtn.addEventListener('click', () => {
             showModal(
                'Confirm Submission',
                'Are you sure you want to submit your answers? You cannot change them after submitting.',
                'Submit',
                submitQuiz
            );
        });
        
        retakeBtn.addEventListener('click', () => {
            shuffleArray(quizData);
            startQuiz();
        });
        
        modalCancelBtn.addEventListener('click', hideModal);
        
        modalConfirmBtn.addEventListener('click', () => {
            if (typeof confirmAction === 'function') {
                confirmAction();
            }
            hideModal();
        });

        // Initial load
        startQuiz();
    </script>

</body>
</html>
