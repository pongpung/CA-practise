<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ICAB BTF Exam â€“Chapter 2: Managing a Business</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .question-tracker-item {
            transition: all 0.3s ease;
        }
        .explanation {
            background-color: #f0f9ff;
            border-left: 4px solid #0ea5e9;
            padding: 12px;
            margin-top: 10px;
            border-radius: 0 8px 8px 0;
        }
        .correct-answer-highlight {
            background-color: #dcfce7 !important;
            border: 2px solid #22c55e !important;
        }
        .incorrect-answer-highlight {
            background-color: #fee2e2 !important;
            border: 2px solid #ef4444 !important;
        }
        .user-selected-highlight {
           box-shadow: 0 0 0 2px #3b82f6;
        }
    </style>
</head>
<body class="bg-slate-100 text-slate-800">

    <div id="quiz-container" class="max-w-7xl mx-auto p-4 sm:p-6 lg:p-8">
        <header class="mb-6">
            <h1 class="text-2xl sm:text-3xl font-bold text-slate-900">ICAB Accounting Exam â€“ Chapter 2: Managing a Business</h1>
            <p class="text-slate-600">Total Questions: 50 | Time Limit: 45 Minutes | 2 Marks per Question</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
            <!-- Left Side: Question Tracker -->
            <aside class="lg:col-span-1 bg-white p-4 rounded-lg shadow-md h-fit sticky top-8">
                <h2 class="text-lg font-semibold mb-3">Question Tracker</h2>
                <div id="question-tracker" class="grid grid-cols-5 sm:grid-cols-6 lg:grid-cols-5 gap-2">
                    <!-- Tracker items will be generated by JS -->
                </div>
                <div class="mt-4 space-y-2 text-sm">
                    <div class="flex items-center"><span class="w-4 h-4 bg-white border border-slate-300 rounded-full mr-2"></span> Not Answered</div>
                    <div class="flex items-center"><span class="w-4 h-4 bg-green-500 rounded-full mr-2"></span> Answered</div>
                    <div class="flex items-center"><span class="w-4 h-4 bg-red-500 rounded-full mr-2"></span> Flagged</div>
                </div>
                 <div class="mt-6">
                    <button id="submit-btn" class="w-full px-6 py-3 bg-green-600 text-white font-bold rounded-lg hover:bg-green-700 transition-colors">Submit Quiz</button>
                </div>
            </aside>

            <!-- Center: Question and Answer -->
            <main class="lg:col-span-3">
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <div class="flex justify-between items-center mb-4">
                        <div id="timer" class="text-xl font-bold text-sky-600">45:00</div>
                        <button id="flag-btn" class="flex items-center px-4 py-2 border border-slate-300 rounded-lg hover:bg-slate-50 transition">
                            <svg class="w-5 h-5 mr-2 text-red-500" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 3a1 1 0 000 2v11a1 1 0 100 2h13.586l-1-1H4a1 1 0 110-2h12V8H4a1 1 0 01-1-1V5h12l1-2H3z"></path></svg>
                            <span id="flag-btn-text">Flag for Review</span>
                        </button>
                    </div>

                    <div id="question-area">
                        <div class="mb-4">
                            <span id="question-number" class="font-semibold text-lg"></span>
                            <p id="question-text" class="text-lg mt-1"></p>
                            <p id="question-marks" class="text-sm text-slate-500"></p>
                            <p id="question-type-info" class="text-sm text-blue-600 mt-1"></p>
                        </div>
                        <div id="options-container" class="space-y-3">
                            <!-- Options will be generated by JS -->
                        </div>
                    </div>

                    <div class="mt-8 flex justify-between">
                        <button id="prev-btn" class="px-6 py-2 bg-slate-200 text-slate-800 rounded-lg hover:bg-slate-300 disabled:opacity-50 disabled:cursor-not-allowed">Previous</button>
                        <button id="next-btn" class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">Next</button>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Results Screen -->
    <div id="results-container" class="hidden max-w-4xl mx-auto p-4 sm:p-6 lg:p-8">
        <div class="bg-white p-6 rounded-lg shadow-md">
            <h1 class="text-3xl font-bold text-center text-slate-900 mb-2">Quiz Results</h1>
            <p id="quiz-difficulty-indicator" class="text-center text-lg font-semibold mb-6"></p>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-center mb-8">
                <div class="bg-blue-100 p-4 rounded-lg">
                    <p class="text-sm text-blue-800 font-semibold">Total Score</p>
                    <p id="total-score" class="text-3xl font-bold text-blue-800"></p>
                    <p id="score-percentage" class="text-md font-medium text-blue-700"></p>
                </div>
                <div class="bg-green-100 p-4 rounded-lg">
                    <p class="text-sm text-green-800 font-semibold">Correct / Incorrect</p>
                    <p id="correct-count" class="text-3xl font-bold text-green-800"></p>
                    <p id="incorrect-count" class="text-lg font-medium text-red-700"></p>
                </div>
            </div>

            <div id="improvement-topics-container" class="mb-8 p-4 bg-amber-50 border-l-4 border-amber-400 rounded-r-lg">
                <h2 class="text-xl font-semibold mb-3">Topics for Improvement</h2>
                <ul id="improvement-topics-list" class="list-disc list-inside space-y-1 text-slate-700">
                    <!-- Topics will be generated by JS -->
                </ul>
            </div>

            <h2 class="text-2xl font-semibold mb-4 border-b pb-2">Detailed Question Review</h2>
            <div id="detailed-results" class="space-y-6">
                <!-- Detailed results will be generated by JS -->
            </div>
             <div class="text-center mt-8">
                <button onclick="location.reload()" class="px-8 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-lg font-semibold">Retake Quiz</button>
            </div>
        </div>
         <footer class="text-center mt-8 text-sm text-slate-500">
            <p class="font-semibold">Prepared by:</p>
            <p><a href="https://www.linkedin.com/in/k-m-mahafuzul-alam" target="_blank" class="text-blue-600 hover:underline">ðŸ”— K.M. Mahafuzul Alam</a></p>
            <p>ðŸ“ž WhatsApp: 01728-928984 | ðŸ“§ Email: kmmhafuzulalam@gmail.com</p>
        </footer>
    </div>


    <script>
        const quizData = [
            // Standard MCQs
            {
                question: "According to Metcalf and Harper (1942), what is the definition of management?",
                options: [
                    "The process of achieving organizational goals through planning, organizing, leading, and controlling.",
                    "Getting things done through other people.",
                    "A social arrangement for the controlled performance of collective goals.",
                    "The art of maximizing efficiency and productivity."
                ],
                correct: [1],
                type: 'single',
                topic: "Nature of Management"
            },
            {
                question: "Which of the following types of power, as classified by French and Raven, is based on a manager's control over valued resources like financial rewards or information?",
                options: [
                    "Coercive power",
                    "Legitimate power",
                    "Reward power",
                    "Referent power"
                ],
                correct: [2],
                type: 'single',
                topic: "Power and Authority"
            },
            {
                question: "A manager who has authority to provide specialist advice to another department, but has no direct line authority over it, is known as a:",
                options: [
                    "Line manager",
                    "Project manager",
                    "Functional manager",
                    "Staff manager"
                ],
                correct: [3],
                type: 'single',
                topic: "Types of Manager"
            },
            {
                question: "The management process comprises four main tasks. Which of the following is NOT one of these tasks?",
                options: [
                    "Planning",
                    "Organising",
                    "Delegating",
                    "Controlling"
                ],
                correct: [2],
                explanation: "The four main tasks of the management process are Planning, Organising, Controlling, and Leading. Delegating is a tool used within these processes, particularly in organising, but is not one of the four core components itself (Topic 4).",
                topic: "The Management Process"
            },
            {
                question: "According to Henry Mintzberg's managerial roles, which role involves allocating resources, handling disturbances, and acting as an entrepreneur?",
                options: [
                    "Interpersonal role",
                    "Informational role",
                    "Decisional role",
                    "Leadership role"
                ],
                correct: [2],
                type: 'single',
                topic: "Managerial Roles"
            },
            {
                question: "A public sector organization that is inward-looking, aiming to create a stable and controlled internal environment with defined rules and procedures, is best described as having which of Robert E. Quinn's cultural types?",
                options: [
                    "Rational goal culture",
                    "Open systems culture",
                    "Human relations culture",
                    "Internal process culture"
                ],
                correct: [3],
                type: 'single',
                topic: "Organizational Culture"
            },
            {
                question: "Which management model focuses on *how* the organization does things, emphasizing hierarchy, detailed rules, and impersonality, rather than *why* it does them?",
                options: [
                    "Rational goal model",
                    "Internal process model",
                    "Open systems model",
                    "Human relations model"
                ],
                correct: [1],
                type: 'single',
                topic: "Management Models"
            },
            {
                question: "The '7Ps' of services marketing extend the traditional '4Ps' marketing mix. Which of the following are part of the additional 3Ps for services? (Choose THREE)",
                options: [
                    "Product",
                    "People",
                    "Price",
                    "Processes",
                    "Physical evidence",
                    "Promotion"
                ],
                correct: [1, 3, 4],
                type: 'multiple',
                topic: "Marketing"
            },
            {
                question: "A promotional strategy that focuses on persuading the ultimate consumers to buy a product, creating demand that pulls the product through the distribution channel, is known as a ___ technique.",
                options: [
                    "Push",
                    "Pull",
                    "Direct",
                    "Indirect"
                ],
                correct: [1],
                type: 'fill',
                topic: "Marketing"
            },
            {
                question: "In operations management, the 'four Vs' describe how operations can differ. What does 'Visibility' refer to?",
                options: [
                    "The volume of output produced.",
                    "The range of different products or services offered.",
                    "The extent to which an operation is exposed to its customers.",
                    "The fluctuation in demand over time."
                ],
                correct: [2],
                type: 'single',
                topic: "Operations Management"
            },
            {
                question: "The 'five rights' of procurement aim to secure competitive advantage. Which of the following is NOT one of the five rights?",
                options: [
                    "The right quality",
                    "The right quantity",
                    "The right supplier",
                    "The right price"
                ],
                correct: [2],
                explanation: "The five rights of procurement are ensuring materials/staff are of the right quality, in the right quantity, at the right price, in the right place, at the right time. 'Right supplier' is implicit in achieving these but not explicitly one of the five listed 'rights' (Topic 11.1).",
                topic: "Procurement"
            },
            {
                question: "The 'hard' approach to Human Resource Management (HRM) views employees primarily as:",
                options: [
                    "Valued partners with long-term needs.",
                    "A resource to be planned and managed to meet business objectives.",
                    "Individuals whose well-being is a primary concern.",
                    "Stakeholders with a right to congruence and commitment."
                ],
                correct: [1],
                type: 'single',
                topic: "Human Resource Management"
            },
            {
                question: "In the context of the organisational iceberg, which of the following are considered 'covert' or behavioural aspects? (Choose TWO)",
                options: [
                    "Organisational design",
                    "Financial resources",
                    "Communication patterns",
                    "Political behaviour"
                ],
                correct: [2, 3],
                type: 'multiple',
                topic: "Organisational Behaviour"
            },
            {
                question: "According to Maslow's hierarchy of needs, once an individual's safety and security needs are met, which level of needs becomes the primary motivator?",
                options: [
                    "Physiological needs",
                    "Status/ego needs",
                    "Social needs",
                    "Self-actualisation needs"
                ],
                correct: [2],
                type: 'single',
                topic: "Motivation Theories"
            },
            {
                question: "In Tuckman's model of group development, the stage characterized by conflict, challenges to preconceptions, and competition for roles is known as:",
                options: [
                    "Forming",
                    "Storming",
                    "Norming",
                    "Performing"
                ],
                correct: [1],
                type: 'single',
                topic: "Group Behaviour"
            },
            {
                question: "According to Belbin's team roles, the individual who is thoughtful, thought-provoking, and generates original ideas is the:",
                options: [
                    "Shaper",
                    "Resource-investigator",
                    "Plant",
                    "Evaluator"
                ],
                correct: [2],
                type: 'single',
                topic: "Team Roles"
            },
             {
                question: "Which of the following statements about delegation is correct?",
                options: [
                    "When a manager delegates a task, they also delegate final accountability for its outcome.",
                    "Delegation involves giving a subordinate responsibility and authority, while the manager retains overall responsibility.",
                    "Effective delegation requires the manager to supervise the subordinate's work very closely at all times.",
                    "Only boring and unimportant tasks should be delegated to subordinates."
                ],
                correct: [1],
                type: 'single',
                topic: "Delegation"
            },
            {
                question: "The ability to get things done through the force of personality or 'charisma' is known as:",
                options: [
                    "Legitimate power",
                    "Expert power",
                    "Referent power",
                    "Coercive power"
                ],
                correct: [2],
                type: 'single',
                topic: "Power and Authority"
            },
            {
                question: "Which of the following are key functions within a business as identified in the syllabus?",
                options: [
                    "Marketing, Operations, Legal, and Finance.",
                    "HR, IT, Sales, and Administration.",
                    "Marketing, Operations/Production, Procurement, HR, IT, and Finance.",
                    "All of the above."
                ],
                correct: [2],
                type: 'single',
                topic: "Business Functions"
            },
            {
                question: "A 'B2C' market refers to a business that sells primarily to:",
                options: [
                    "Other businesses",
                    "Government agencies",
                    "Individual consumers",
                    "Non-profit organizations"
                ],
                correct: [2],
                type: 'single',
                topic: "Marketing"
            },
            {
                question: "The research and development (R&D) function may involve which of the following activities? (Choose all that apply)",
                options: [
                    "Pure research",
                    "Applied research",
                    "Development",
                    "Market testing"
                ],
                correct: [0, 1, 2],
                type: 'multiple',
                explanation: "R&D involves pure research (no obvious commercial end), applied research (obvious commercial end), and development (using existing knowledge for new products/systems). Market testing is a marketing function, not an R&D one. (Topic 10.2)",
                topic: "Operations Management"
            },
            {
                question: "The Harvard four Cs model of HRM evaluates the effectiveness of HRM policies. What do the four Cs stand for?",
                options: [
                    "Cost, Competence, Control, Culture",
                    "Commitment, Competence, Congruence, Cost-effectiveness",
                    "Communication, Co-operation, Control, Cost",
                    "Culture, Commitment, Co-ordination, Congruence"
                ],
                correct: [1],
                type: 'single',
                topic: "Human Resource Management"
            },
            {
                question: "In Likert's leadership styles, a manager who imposes decisions, motivates by threats, and centralizes authority is demonstrating a(n) ___ style.",
                options: [
                    "Benevolent-authoritative",
                    "Consultative",
                    "Participative",
                    "Exploitative-authoritative"
                ],
                correct: [3],
                type: 'fill',
                topic: "Leadership Styles"
            },
            {
                question: "Which of the following is NOT a benefit of outsourcing an IT function?",
                options: [
                    "Allowing the business to focus on its core activities.",
                    "Obtaining better IT functions and service than achievable in-house.",
                    "Increased formality and having to manage the provider at arm's length.",
                    "Potential cost savings and access to specialized skills."
                ],
                correct: [2],
                explanation: "Increased formality and arm's-length management are described as new challenges or potential drawbacks of outsourcing, not benefits. (Topic 13.3)",
                topic: "Information Technology"
            },
            {
                question: "All of the following are advantages of delegation EXCEPT:",
                options: [
                    "The manager is relieved of less important activities.",
                    "It makes the subordinate's job more interesting.",
                    "The manager can 'pass the buck' and avoid responsibility.",
                    "It allows for career development and succession planning."
                ],
                correct: [2],
                type: 'single',
                topic: "Delegation"
            },
            
            // Mathematical/Calculation-based MCQs
            {
                question: "A manufacturing unit produces 10,000 widgets per month. The variable cost per widget is BDT 50. The total fixed overheads for the month are BDT 200,000. To achieve a 20% profit margin on total cost, what should be the selling price per widget?",
                options: [
                    "BDT 70",
                    "BDT 84",
                    "BDT 60",
                    "BDT 75"
                ],
                correct: [1],
                explanation: "Total Variable Cost = 10,000 * 50 = BDT 500,000. Total Cost = Total Variable Cost + Fixed Overheads = 500,000 + 200,000 = BDT 700,000. Desired Profit = 20% of Total Cost = 0.20 * 700,000 = BDT 140,000. Total Revenue Needed = Total Cost + Desired Profit = 700,000 + 140,000 = BDT 840,000. Selling Price per Widget = Total Revenue / Number of Widgets = 840,000 / 10,000 = BDT 84.",
                type: 'single',
                topic: "Pricing and Costing"
            },
            {
                question: "A company employs 200 staff. In the last year, 25 employees left the company. What was the labour turnover rate for the year?",
                options: [
                    "10%",
                    "12.5%",
                    "15%",
                    "25%"
                ],
                correct: [1],
                explanation: "Labour Turnover Rate = (Number of employees who left / Average number of employees) * 100. Rate = (25 / 200) * 100 = 12.5%. This is a measure of the 'Commitment' aspect in the Harvard 4Cs model.",
                type: 'single',
                topic: "Human Resource Management"
            },
            {
                question: "An operation has a maximum capacity of 5,000 units per week. Due to seasonal demand, it operates at 90% capacity for 20 weeks, 60% capacity for 20 weeks, and 30% capacity for 12 weeks. What is the average capacity utilisation over the 52-week year?",
                options: [
                    "60.0%",
                    "64.6%",
                    "66.9%",
                    "70.0%"
                ],
                correct: [1],
                explanation: "Total units produced: (5000 * 0.90 * 20) + (5000 * 0.60 * 20) + (5000 * 0.30 * 12) = 90,000 + 60,000 + 18,000 = 168,000 units. Total possible units in a year = 5000 * 52 = 260,000 units. Average Utilisation = (Total units produced / Total possible units) * 100 = (168,000 / 260,000) * 100 = 64.615... â‰ˆ 64.6%. This relates to the 'Variation in demand' V in operations management.",
                type: 'single',
                topic: "Operations Management"
            },
            {
                question: "A marketing campaign costs BDT 500,000. It is expected to increase sales by 4,000 units. The contribution per unit (selling price minus variable cost) is BDT 150. What is the expected Return on Marketing Investment (ROMI)?",
                options: [
                    "10%",
                    "20%",
                    "50%",
                    "120%"
                ],
                correct: [1],
                explanation: "Total Contribution from new sales = 4,000 units * BDT 150/unit = BDT 600,000. Net Profit from campaign = Total Contribution - Campaign Cost = 600,000 - 500,000 = BDT 100,000. ROMI = (Net Profit / Campaign Cost) * 100 = (100,000 / 500,000) * 100 = 20%.",
                type: 'single',
                topic: "Marketing"
            },
            {
                question: "A project team requires one leader, one shaper, one finisher, and equal numbers of plants and evaluators. If the team has a total of 7 members (including the leader, shaper, and finisher), how many plants are on the team?",
                options: [
                    "1",
                    "2",
                    "3",
                    "4"
                ],
                correct: [1],
                explanation: "Total members = 7. Members with fixed roles = 1 (Leader) + 1 (Shaper) + 1 (Finisher) = 3. Remaining members = 7 - 3 = 4. These 4 members must be composed of equal numbers of plants and evaluators. Therefore, there are 4 / 2 = 2 plants and 2 evaluators. This is based on Belbin's team roles.",
                type: 'single',
                topic: "Team Roles"
            },
            // More Standard MCQs
            {
                question: "Which of the following is an example of a 'brown good' in consumer markets?",
                options: [
                    "A refrigerator",
                    "A loaf of bread",
                    "A mobile phone",
                    "An insurance policy"
                ],
                correct: [2],
                type: 'single',
                topic: "Marketing"
            },
            {
                question: "The liability of a person to be called to account for the fulfilment of tasks they have been given is defined as:",
                options: [
                    "Responsibility",
                    "Authority",
                    "Power",
                    "Accountability"
                ],
                correct: [3],
                type: 'single',
                topic: "Nature of Management"
            },
            {
                question: "A business with a culture that looks inwards and focuses on maintaining the well-being of its staff, motivating them with a sense of belonging, is an example of a:",
                options: [
                    "Rational goal culture",
                    "Open systems culture",
                    "Human relations culture",
                    "Internal process culture"
                ],
                correct: [2],
                type: 'single',
                topic: "Organizational Culture"
            },
            {
                question: "In the context of operations management, a high-volume operation is likely to have which of the following characteristics?",
                options: [
                    "High unit costs and flexible processes",
                    "Low unit costs and high specialization of work",
                    "High variety of products and complex work",
                    "Low capacity utilization and high visibility"
                ],
                correct: [1],
                type: 'single',
                topic: "Operations Management"
            },
            {
                question: "Which of the following describes 'Applied Research'?",
                options: [
                    "Original research to obtain new knowledge with no obvious commercial end in view.",
                    "The use of existing knowledge to produce new systems or products.",
                    "Research which has an obvious commercial or practical end in view.",
                    "None of the above."
                ],
                correct: [2],
                type: 'single',
                topic: "Operations Management"
            },
            {
                question: "In a supply chain, the elements that provide materials and production, such as suppliers, are known as:",
                options: [
                    "Downstream supply chain members",
                    "Tier 2 customers",
                    "Upstream supply chain members",
                    "Logistics partners"
                ],
                correct: [2],
                type: 'single',
                topic: "Procurement"
            },
            {
                question: "Which law in Bangladesh primarily governs employment relationships, including conditions of service, termination, and worker's health and safety, serving a similar broad purpose to acts like the UK's Equality Act 2010 in setting employment standards?",
                options: [
                    "The Companies Act 1994",
                    "The Contract Act 1872",
                    "The Bangladesh Labour Act 2006",
                    "The Partnership Act 1932"
                ],
                correct: [2],
                explanation: "The Bangladesh Labour Act, 2006 is the principal legislation governing labour and employment in Bangladesh. It consolidates various laws related to employment conditions, workplace safety, trade unions, and industrial disputes, making it the most relevant equivalent to broad employment standards legislation mentioned in the text.",
                type: 'single',
                topic: "Human Resource Management"
            },
            {
                question: "In Belbin's team roles, the 'Finisher' is responsible for:",
                options: [
                    "Generating new and creative ideas.",
                    "Co-ordinating the team and operating through others.",
                    "Critically analyzing others' ideas.",
                    "Progress chasing and ensuring timetables are met."
                ],
                correct: [3],
                type: 'single',
                topic: "Team Roles"
            },
            {
                question: "A manager who has complete confidence in subordinates, motivates by rewards and participation, and delegates extensively is using which of Likert's leadership styles?",
                options: [
                    "Exploitative-authoritative",
                    "Benevolent-authoritative",
                    "Consultative",
                    "Participative"
                ],
                correct: [3],
                type: 'single',
                topic: "Leadership Styles"
            },
            {
                question: "The 'soft' approach to HRM would most likely focus on which of the following?",
                options: [
                    "Controlling staff costs to maximize efficiency.",
                    "Developing individual skills and the welfare of staff.",
                    "Planning human resources to meet the strategic objectives of the business.",
                    "Maximizing employee effectiveness through strict performance metrics."
                ],
                correct: [1],
                type: 'single',
                topic: "Human Resource Management"
            },
            
            // Scenario/Case-based MCQs
            {
                case_title: "Case Study: AlphaTech Bangladesh Ltd.",
                case_text: "AlphaTech Bangladesh Ltd. is a fast-growing software development company. The CEO, Mr. Rahman, believes in a hands-on approach. He centralizes most major decisions and has designed a system of detailed work methods and division of labour to maximize output. The company's primary focus is on meeting ambitious quarterly sales targets to satisfy its investors. The culture is highly competitive, and employees are motivated by achieving these external goals. Recently, the company has faced high employee turnover. The HR manager, Ms. Anika, has proposed a new initiative focusing on employee well-being, team-building, and creating a greater sense of belonging. She argues this will improve long-term performance, even if it means slightly less focus on short-term targets.",
                questions: [
                    {
                        question: "Based on the case, AlphaTech's current management approach most closely aligns with which management model?",
                        options: [
                            "Internal process model",
                            "Human relations model",
                            "Rational goal model",
                            "Open systems model"
                        ],
                        correct: [2],
                        explanation: "The focus on achieving external goals (sales targets), systematic work methods, and centralized planning to maximize output are all hallmarks of the Rational Goal Model. (Topic 7.2)",
                        type: 'single',
                        topic: "Management Models"
                    },
                    {
                        question: "Mr. Rahman's leadership style, as described in the case, is closest to which of Likert's styles?",
                        options: [
                            "Participative",
                            "Consultative",
                            "Benevolent-authoritative",
                            "Exploitative-authoritative"
                        ],
                        correct: [2],
                        explanation: "While he isn't described as using threats (exploitative), his centralized decision-making and hands-on control with a focus on rewards (implied by meeting targets for investors) align well with a Benevolent-Authoritative style, which is a condescending master-servant relationship. It is certainly not consultative or participative.",
                        type: 'single',
                        topic: "Leadership Styles"
                    },
                    {
                        question: "Ms. Anika's proposed initiative is an attempt to shift the company's culture towards a:",
                        options: [
                            "Rational goal culture",
                            "Internal process culture",
                            "Open systems culture",
                            "Human relations culture"
                        ],
                        correct: [3],
                        explanation: "Her focus on employee well-being, team-building, and sense of belonging are the key characteristics of a Human Relations Culture, which looks inward and prioritizes the needs of its people. (Topic 6)",
                        type: 'single',
                        topic: "Organizational Culture"
                    },
                    {
                        question: "The high employee turnover at AlphaTech is a failure in which of the 'four Cs' of the Harvard HRM model?",
                        options: [
                            "Competence",
                            "Congruence",
                            "Cost-effectiveness",
                            "Commitment"
                        ],
                        correct: [3],
                        explanation: "High employee turnover is a direct measure of a lack of employee loyalty and motivation, which falls under the 'Commitment' aspect of the Harvard model. (Topic 12.2)",
                        type: 'single',
                        topic: "Human Resource Management"
                    }
                ]
            },
            
            // More Standard MCQs
            {
                question: "Which type of power is associated with a particular position in the organisation, granting the right to issue instructions?",
                options: [
                    "Expert power",
                    "Legitimate power",
                    "Referent power",
                    "Reward power"
                ],
                correct: [1],
                type: 'single',
                topic: "Power and Authority"
            },
            {
                question: "An operations process characterized by high variety and low volume (e.g., a bespoke tailor) would typically result in:",
                options: [
                    "Low unit costs and high standardization",
                    "High unit costs and a need for flexibility",
                    "Low staff skills and repetitive tasks",
                    "High capacity utilization and stable demand"
                ],
                correct: [1],
                type: 'single',
                topic: "Operations Management"
            },
            {
                question: "According to the syllabus, which of the following is NOT a main type of promotion in the communication mix?",
                options: [
                    "Advertising",
                    "Public relations",
                    "Product placement",
                    "Personal selling"
                ],
                correct: [2],
                explanation: "The five main types listed are Advertising, Sales promotion, Public relations, Digital marketing, and Personal selling. Product placement can be a form of PR or advertising, but it's not listed as a main type. (Topic 9.7)",
                type: 'single',
                topic: "Marketing"
            },
            {
                question: "In the organisational iceberg model, 'Rules and regulations' are considered a(n) ___ variable.",
                options: [
                    "Covert",
                    "Behavioural",
                    "Overt",
                    "Informal"
                ],
                correct: [2],
                type: 'fill',
                topic: "Organisational Behaviour"
            },
            {
                question: "Which stage of Tuckman's group development model involves establishing the norms, behaviour patterns, and roles under which the group will operate?",
                options: [
                    "Forming",
                    "Storming",
                    "Norming",
                    "Performing"
                ],
                correct: [2],
                type: 'single',
                topic: "Group Behaviour"
            },
            {
                question: "The ultimate user of a good or service is known as the:",
                options: [
                    "Customer",
                    "Client",
                    "Consumer",
                    "Purchaser"
                ],
                correct: [2],
                type: 'single',
                topic: "Marketing"
            }
        ];

        let flattenedQuizData = [];
        quizData.forEach(item => {
            if (item.case_title) {
                item.questions.forEach(q => {
                    flattenedQuizData.push({ ...q, case_title: item.case_title, case_text: item.case_text });
                });
            } else {
                flattenedQuizData.push(item);
            }
        });

        let currentQuestionIndex = 0;
        let userAnswers = new Array(flattenedQuizData.length).fill(null);
        let flaggedQuestions = new Array(flattenedQuizData.length).fill(false);
        let timerInterval;

        const timerEl = document.getElementById('timer');
        const questionTrackerEl = document.getElementById('question-tracker');
        const questionNumberEl = document.getElementById('question-number');
        const questionTextEl = document.getElementById('question-text');
        const questionMarksEl = document.getElementById('question-marks');
        const questionTypeInfoEl = document.getElementById('question-type-info');
        const optionsContainerEl = document.getElementById('options-container');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const submitBtn = document.getElementById('submit-btn');
        const flagBtn = document.getElementById('flag-btn');
        const flagBtnText = document.getElementById('flag-btn-text');
        
        function startTimer(duration) {
            let timer = duration * 60;
            timerInterval = setInterval(() => {
                let minutes = parseInt(timer / 60, 10);
                let seconds = parseInt(timer % 60, 10);

                minutes = minutes < 10 ? "0" + minutes : minutes;
                seconds = seconds < 10 ? "0" + seconds : seconds;

                timerEl.textContent = minutes + ":" + seconds;

                if (--timer < 0) {
                    clearInterval(timerInterval);
                    submitQuiz();
                }
            }, 1000);
        }

        function createQuestionTracker() {
            questionTrackerEl.innerHTML = '';
            flattenedQuizData.forEach((_, index) => {
                const item = document.createElement('div');
                item.textContent = index + 1;
                item.classList.add('question-tracker-item', 'w-10', 'h-10', 'flex', 'items-center', 'justify-center', 'font-semibold', 'rounded-full', 'cursor-pointer', 'border');
                updateTrackerItemState(item, index);
                item.addEventListener('click', () => {
                    currentQuestionIndex = index;
                    displayQuestion();
                });
                questionTrackerEl.appendChild(item);
            });
        }
        
        function updateTrackerItemState(item, index) {
            item.classList.remove('bg-white', 'border-slate-300', 'bg-green-500', 'text-white', 'border-green-500', 'bg-red-500', 'border-red-500');
            if (flaggedQuestions[index]) {
                item.classList.add('bg-red-500', 'text-white', 'border-red-500');
            } else if (userAnswers[index] !== null) {
                item.classList.add('bg-green-500', 'text-white', 'border-green-500');
            } else {
                item.classList.add('bg-white', 'border-slate-300');
            }
        }

        function displayQuestion() {
            const questionData = flattenedQuizData[currentQuestionIndex];
            
            const existingCaseStudy = document.getElementById('case-study-box');
            if (existingCaseStudy) existingCaseStudy.remove();

            if (questionData.case_title) {
                const caseBox = document.createElement('div');
                caseBox.id = 'case-study-box';
                caseBox.classList.add('mb-6', 'p-4', 'bg-slate-50', 'border-l-4', 'border-blue-500', 'rounded-r-lg');
                caseBox.innerHTML = `
                    <h3 class="font-bold text-lg text-slate-800">${questionData.case_title}</h3>
                    <p class="mt-2 text-slate-600">${questionData.case_text}</p>
                `;
                document.getElementById('question-area').prepend(caseBox);
            }

            questionNumberEl.textContent = `Question ${currentQuestionIndex + 1}`;
            questionMarksEl.textContent = '(2 Marks)';
            
            questionTypeInfoEl.textContent = '';
            if (questionData.type === 'multiple') {
                questionTypeInfoEl.textContent = `(Choose ${questionData.correct.length} correct answers)`;
            }

            optionsContainerEl.innerHTML = '';
            
            if (questionData.type === 'fill') {
                const [before, after] = questionData.question.split('___');
                questionTextEl.innerHTML = `${before} <select id="fill-in-blank-select" class="border border-gray-300 rounded-md p-1 mx-1 text-base"></select> ${after || ''}`;
                const selectEl = document.getElementById('fill-in-blank-select');
                selectEl.innerHTML = `<option value="">Select...</option>` + questionData.options.map((opt, i) => `<option value="${i}">${opt}</option>`).join('');
                if (userAnswers[currentQuestionIndex] !== null) {
                    selectEl.value = userAnswers[currentQuestionIndex][0];
                }
                selectEl.addEventListener('change', (e) => {
                    userAnswers[currentQuestionIndex] = e.target.value === "" ? null : [parseInt(e.target.value)];
                    updateQuestionTracker();
                });
            } else {
                questionTextEl.textContent = questionData.question;
                questionData.options.forEach((option, index) => {
                    const optionId = `q${currentQuestionIndex}-opt${index}`;
                    const wrapper = document.createElement('div');
                    const inputType = questionData.type === 'multiple' ? 'checkbox' : 'radio';
                    wrapper.innerHTML = `
                        <label for="${optionId}" class="flex items-center p-3 border border-slate-300 rounded-lg cursor-pointer hover:bg-slate-50 transition has-[:checked]:bg-blue-50 has-[:checked]:border-blue-500">
                            <input type="${inputType}" id="${optionId}" name="question${currentQuestionIndex}" value="${index}" class="mr-3 h-5 w-5 ${inputType === 'checkbox' ? 'rounded' : 'rounded-full'} text-blue-600 focus:ring-blue-500 border-gray-300">
                            <span class="flex-1">${String.fromCharCode(65 + index)}. ${option}</span>
                        </label>
                    `;
                    optionsContainerEl.appendChild(wrapper);
                });
                optionsContainerEl.querySelectorAll('input').forEach(input => {
                    if (userAnswers[currentQuestionIndex] !== null && userAnswers[currentQuestionIndex].includes(parseInt(input.value))) {
                        input.checked = true;
                    }
                    input.addEventListener('change', handleOptionChange);
                });
            }

            updateNavigationButtons();
            updateFlagButton();
        }

        function handleOptionChange(event) {
            const questionData = flattenedQuizData[currentQuestionIndex];
            if (questionData.type === 'multiple') {
                if (userAnswers[currentQuestionIndex] === null) {
                    userAnswers[currentQuestionIndex] = [];
                }
                const value = parseInt(event.target.value);
                if (event.target.checked) {
                    userAnswers[currentQuestionIndex].push(value);
                } else {
                    userAnswers[currentQuestionIndex] = userAnswers[currentQuestionIndex].filter(v => v !== value);
                }
                if(userAnswers[currentQuestionIndex].length === 0) {
                    userAnswers[currentQuestionIndex] = null;
                }
            } else {
                userAnswers[currentQuestionIndex] = [parseInt(event.target.value)];
            }
            updateQuestionTracker();
        }

        function updateQuestionTracker() {
            const items = questionTrackerEl.querySelectorAll('.question-tracker-item');
            items.forEach((item, index) => updateTrackerItemState(item, index));
        }

        function updateNavigationButtons() {
            prevBtn.disabled = currentQuestionIndex === 0;
            nextBtn.style.display = currentQuestionIndex === flattenedQuizData.length - 1 ? 'none' : 'inline-flex';
        }
        
        function updateFlagButton() {
            if (flaggedQuestions[currentQuestionIndex]) {
                flagBtn.classList.add('bg-red-100');
                flagBtnText.textContent = 'Unflag';
            } else {
                flagBtn.classList.remove('bg-red-100');
                flagBtnText.textContent = 'Flag for Review';
            }
        }

        function submitQuiz() {
            clearInterval(timerInterval);
            document.getElementById('quiz-container').classList.add('hidden');
            document.getElementById('results-container').classList.remove('hidden');
            calculateAndShowResults();
        }

        function calculateAndShowResults() {
            let score = 0;
            let correctCount = 0;
            let incorrectTopics = new Set();
            const detailedResultsEl = document.getElementById('detailed-results');
            detailedResultsEl.innerHTML = '';

            flattenedQuizData.forEach((q, index) => {
                const userAnswer = userAnswers[index];
                const isCorrect = userAnswer !== null && 
                                  q.correct.length === userAnswer.length && 
                                  q.correct.every(val => userAnswer.includes(val));

                if (isCorrect) {
                    score += 2;
                    correctCount++;
                } else {
                    incorrectTopics.add(q.topic);
                }

                // Render detailed result for each question
                const resultItem = document.createElement('div');
                resultItem.classList.add('border-t', 'pt-4');
                
                let optionsHtml = '';
                q.options.forEach((opt, i) => {
                    let classes = 'flex items-center p-3 border border-slate-300 rounded-lg mt-2';
                    const isCorrectOption = q.correct.includes(i);
                    const isUserSelected = userAnswer ? userAnswer.includes(i) : false;

                    if (isCorrectOption) {
                        classes += ' correct-answer-highlight';
                    } else if (isUserSelected && !isCorrectOption) {
                        classes += ' incorrect-answer-highlight';
                    }
                    
                    if(isUserSelected) {
                        classes += ' user-selected-highlight';
                    }

                    optionsHtml += `<div class="${classes}">${String.fromCharCode(65 + i)}. ${opt}</div>`;
                });
                
                let explanationHtml = '';
                if (q.explanation) {
                    explanationHtml = `<div class="explanation"><strong>ðŸ“– Explanation:</strong> ${q.explanation}</div>`;
                } else {
                     explanationHtml = `<div class="explanation"><strong>ðŸ“– Explanation:</strong> The correct answer is based on the principles outlined in Topic '${q.topic}' of the ICAB syllabus material.</div>`;
                }


                resultItem.innerHTML = `
                    <p class="font-semibold text-lg">Question ${index + 1}: ${q.question.replace('___', `<strong>[${q.options[q.correct[0]]}]</strong>`)}</p>
                    <div class="mt-2">${optionsHtml}</div>
                    ${explanationHtml}
                `;
                detailedResultsEl.appendChild(resultItem);
            });

            const totalQuestions = flattenedQuizData.length;
            const incorrectCount = totalQuestions - correctCount;
            const scorePercentage = (score / (totalQuestions * 2)) * 100;
            
            document.getElementById('total-score').textContent = `${score} / ${totalQuestions * 2}`;
            document.getElementById('score-percentage').textContent = `${scorePercentage.toFixed(1)}%`;
            document.getElementById('correct-count').textContent = `${correctCount} Correct`;
            document.getElementById('incorrect-count').textContent = `${incorrectCount} Incorrect`;
            
            const improvementListEl = document.getElementById('improvement-topics-list');
            improvementListEl.innerHTML = '';
            if (incorrectTopics.size > 0) {
                incorrectTopics.forEach(topic => {
                    const li = document.createElement('li');
                    li.textContent = topic;
                    improvementListEl.appendChild(li);
                });
            } else {
                improvementListEl.innerHTML = '<li>Excellent work! No specific areas for improvement identified.</li>';
            }
            
            let difficulty = scorePercentage >= 70 ? "Regular" : "Tricky";
            document.getElementById('quiz-difficulty-indicator').textContent = `Quiz Difficulty: ${difficulty}`;

        }

        // Event Listeners
        prevBtn.addEventListener('click', () => {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                displayQuestion();
            }
        });

        nextBtn.addEventListener('click', () => {
            if (currentQuestionIndex < flattenedQuizData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            }
        });

        submitBtn.addEventListener('click', () => {
            submitQuiz();
        });
        
        flagBtn.addEventListener('click', () => {
            flaggedQuestions[currentQuestionIndex] = !flaggedQuestions[currentQuestionIndex];
            updateFlagButton();
            updateQuestionTracker();
        });

        // Initial Load
        createQuestionTracker();
        displayQuestion();
        startTimer(45);

    </script>
</body>
</html>
